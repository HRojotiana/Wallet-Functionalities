openapi: 3.0.1
info:
  title: Wallet API
  version: 1.0.0
paths:
  /user:
    get:
      security:
        - apiKey: []
      
      tags:
        - "Users"
      summary: Show all users
      
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"

         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    put:
      tags:
        - "Users"
      security:
        - apiKey: []
      summary: Update user
      parameters:
        - name: "userID"
          in: path
          description: "ID of the user to be updated"
          required: true
          schema:
            type: string
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    delete:
      security:
        - apiKey: []
      tags:
        - "Users"
      summary: Delete all users
      responses:
         '200':
            description: All users have been deleted
           
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    post:
      security:
        - apiKey: []
      tags:
        - "Users"
      summary: Create a new user
      requestBody:
        $ref: "#/components/requestBodies/UserRequestBody"
        
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'


  /user/{userID}:
    get:
      tags:
        - "Users"
      security:
        - apiKey: []
      summary: Show user(s) by ID
      parameters:
        - name: userID
          in: path
          required: true
          description : User's ID
          schema:
            type: string
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    delete:
      security:
        - apiKey: []
      tags:
        - "Users"
      summary: Delete user by ID
      parameters:
        - name: userID
          in: path
          description: "ID of the user to be deleted"
          required: true
          schema:
            type: string
      responses:
         '200':
            description: User deleted successfully
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'

  /account/{accountID}:
    get:
      tags:
        - "Accounts"
      summary: Get account details by ID
      parameters:
        - name: accountID
          required: true
          in: path
          description: ID of the account to retrieve
          schema:
            type: string
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Account"
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    put:
      tags:
        - "Accounts"
      summary: Update account details by ID
      parameters:
        - name: Update account details by ID
          in: path
          required: true
          description: ID of the account to update
          schema:
            type: string
      requestBody:
        $ref: "#/components/schemas/Account"
      responses:
         '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Account"
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
    delete:
      tags:
        - "Accounts"
      summary: Delete account by ID
      parameters:
        - name: accountID
          in: path
          description: "ID of the account to be deleted"
          required: true
          schema: 
            type: string
      responses:
         '200':
            description: Account deleted successfully
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'
  /account:
    post:
      tags:
        - "Accounts"
      summary: Create a new account
      requestBody:
         $ref: "#/components/requestBodies/AccountRequestBody"
        
      responses:
         '200':
            description: Account created successfully
            content:
              application/json:
                schema:
                          $ref: "#/components/schemas/Account"
               
         '404':
           $ref: '#/components/responses/BadRequest'
         '500':
          $ref: '#/components/responses/ServerError'


components:
  responses:
    Success:
      description: Successful request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/User'
    BadRequest:
      description: Bad Request
      content:
        application/json:
          example:
            error: "Bad Request"
    ServerError:
      description: Internal Server Error
      content:
        application/json:
          example:
            error: "Internal Server Error"
  requestBodies:
    AccountRequestBody:
       content:
        application/json:
          schema:
            $ref: "#/components/schemas/Account"
    UserRequestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              username:
                type: string
              email:
                type: string
              password: 
                type: string
            $ref: "#/components/schemas/User"
  securitySchemes:
    apiKey: 
      type: apiKey
      in: header
      name: Authorization
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
          description: Identifier for the user
        username:
          type: string
          minLength: 2
        password:
          type: string
        account:
          $ref: "#/components/schemas/Account"
        currencies:
         $ref: "#/components/schemas/Currencies"
      required:
        - "username"
        - "password"
    Account:
      type: object
      properties:
        user:
          $ref: "#/components/schemas/User"
        accountID:
          type: string
        accountBalance:
          type: integer
        accountCurrency:
           $ref: "#/components/schemas/Currencies"
        accountType: 
          type: string
        accountStatus:
          type: string
        transactionHistory:
          type: string
          #liste des transactions
        creationDate:
          type: string
          format: date
        sortBy:
          type: string
          enum: [balance, type, status, creationDate]
        sortOrder:
          type: string
          enum: [asc, desc]
    Currencies:
      type: object
      properties:
        currencyCode:
          type: integer
        currencyName:
          type: string
        currencySymbol:
          type: string
        currencyUnit:
          type: string
        lastUpdated: 
          type: string
          format: date
        exchangeRate:
          type: string
          #taux de change par rapport Ã  une devise


    
